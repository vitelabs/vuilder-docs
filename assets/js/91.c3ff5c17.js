(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{695:function(t,a,e){"use strict";e.r(a);var c=e(0),o=Object(c.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"start"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#start"}},[t._v("#")]),t._v(" Start")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("Tip")]),t._v(" "),e("p",[t._v("It is easier to use an SDK. e.g. "),e("RouterLink",{attrs:{to:"/SDK/vitejs/"}},[t._v("Vite.js")]),t._v(" or ViteJ to create or call smart contracts")],1)]),t._v(" "),e("h2",{attrs:{id:"how-to-create-contract"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-to-create-contract"}},[t._v("#")]),t._v(" How to Create Contract")]),t._v(" "),e("p",[t._v("To create a contract, one needs to send a transaction with block type 1 in following steps:")]),t._v(" "),e("ol",[e("li",[t._v("Call "),e("RouterLink",{attrs:{to:"/api/contract/contract.html#contract-createcontractaddress"}},[e("code",[t._v("contract_createContractToAddress")])]),t._v(" to generate a new contract address;")],1),t._v(" "),e("li",[t._v("If the contract constructor has input parameters, encode the arguments according to ABI;")]),t._v(" "),e("li",[t._v("Compose block data. The data consists of a prefix of 14 bytes (10-byte consensus group id + 1-byte contract type + 1-byte response latency + 1-byte random degree + 1-byte quota multiplier), contract's compiled code and encoded arguments.")]),t._v(" "),e("li",[t._v("Create an account block and set all necessary fields. Note that "),e("code",[t._v("toAddress")]),t._v(" is the contract address generated in step 1. Set "),e("code",[t._v("blockType")]),t._v(" = 1 and "),e("code",[t._v("fee")]),t._v(" as 10 VITE, also set "),e("code",[t._v("amount")]),t._v(" and "),e("code",[t._v("tokenId")]),t._v(" if you want to transfer some tokens to the contract (the constructor must be payable).")]),t._v(" "),e("li",[t._v("Call "),e("RouterLink",{attrs:{to:"/api/ledger.html#ledger-sendrawtransaction"}},[e("code",[t._v("ledger_sendRawTransaction")])]),t._v(" to send the transaction.")],1)]),t._v(" "),e("p",[t._v("See "),e("RouterLink",{attrs:{to:"/vite-basics/smart-contract.html"}},[t._v("here")]),t._v(" for more information.")],1),t._v(" "),e("h2",{attrs:{id:"how-to-call-contract"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-to-call-contract"}},[t._v("#")]),t._v(" How to Call Contract")]),t._v(" "),e("p",[t._v("To call a contract, one needs to send a transaction to the smart contract with encoded method name and arguments, as in following steps:")]),t._v(" "),e("ol",[e("li",[t._v("Encode the function call according to ABI;")]),t._v(" "),e("li",[t._v("Create an account block and set all necessary fields. Note that "),e("code",[t._v("toAddress")]),t._v(" is the contract address and "),e("code",[t._v("data")]),t._v(" is the output in step 1. Set "),e("code",[t._v("blockType")]),t._v(" = 2, also set "),e("code",[t._v("amount")]),t._v(" and "),e("code",[t._v("tokenId")]),t._v(" if you want to transfer some tokens (the calling function must be payable).")]),t._v(" "),e("li",[t._v("Call "),e("RouterLink",{attrs:{to:"/api/ledger.html#ledger-sendrawtransaction"}},[e("code",[t._v("ledger_sendRawTransaction")])]),t._v(" to send the transaction.")],1)]),t._v(" "),e("h2",{attrs:{id:"how-to-read-contract-states"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-to-read-contract-states"}},[t._v("#")]),t._v(" How to Read Contract States")]),t._v(" "),e("p",[t._v("A contract's public states can be accessed off-chain through API "),e("code",[t._v("contract_query")]),t._v(" (or "),e("code",[t._v("contract_callOffChainMethod")]),t._v(" in Solidity++ 0.4) with following steps:")]),t._v(" "),e("ol",[e("li",[t._v("Encode the view function call (or off-chain method in Solidity++ 0.4) according to ABI.")]),t._v(" "),e("li",[t._v("Call "),e("RouterLink",{attrs:{to:"/api/contract/contract.html#contract-query"}},[e("code",[t._v("contract_query")])]),t._v(" or "),e("RouterLink",{attrs:{to:"/api/contract/contract.html#contract-calloffchainmethod"}},[e("code",[t._v("contract_callOffChainMethod")])]),t._v(" to read contract states.")],1)]),t._v(" "),e("h2",{attrs:{id:"how-to-call-built-in-contract"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-to-call-built-in-contract"}},[t._v("#")]),t._v(" How to Call Built-in Contract")]),t._v(" "),e("p",[t._v("Calling built-in contract is exactly the same as calling an ordinary contract.")]),t._v(" "),e("p",[t._v("Vite has three built-in contracts: Built-in Quota Contract, Built-in Asset Contract and Built-in Consensus Contract, which will be covered in next chapters.")]),t._v(" "),e("blockquote",[e("p",[t._v("Note: ViteX is also implemented as built-in contracts.")])]),t._v(" "),e("h2",{attrs:{id:"built-in-contract-callbacks"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#built-in-contract-callbacks"}},[t._v("#")]),t._v(" Built-in Contract Callbacks")]),t._v(" "),e("p",[t._v("Some built-in contracts have declared callbacks. The callbacks are used to receive async calling results, and should be implemented by the contract who calls the built-in contract.\nFor example, the following ABI declares a function "),e("code",[t._v("StakeForQuotaWithCallback")]),t._v(" with a callback with the same name.\nLet's assume a contract A calls the function to acquire quota for beneficiary B. In order to receive staking result, A implements the callback so the built-in Quota contract can send the result back in.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",[t._v('In Vite\'s VM, callbacks are implemented as external functions adding a tailing "Callback" to the original name.')])]),t._v(" "),e("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"WwogIHsmcXVvdDt0eXBlJnF1b3Q7OiZxdW90O2Z1bmN0aW9uJnF1b3Q7LCZxdW90O25hbWUmcXVvdDs6JnF1b3Q7U3Rha2VGb3JRdW90YVdpdGhDYWxsYmFjayZxdW90OywgJnF1b3Q7aW5wdXRzJnF1b3Q7Olt7JnF1b3Q7bmFtZSZxdW90OzomcXVvdDtiZW5lZmljaWFyeSZxdW90OywmcXVvdDt0eXBlJnF1b3Q7OiZxdW90O2FkZHJlc3MmcXVvdDt9LHsmcXVvdDtuYW1lJnF1b3Q7OiZxdW90O3N0YWtlSGVpZ2h0JnF1b3Q7LCZxdW90O3R5cGUmcXVvdDs6JnF1b3Q7dWludDY0JnF1b3Q7fV19LAogIHsmcXVvdDt0eXBlJnF1b3Q7OiZxdW90O2NhbGxiYWNrJnF1b3Q7LCZxdW90O25hbWUmcXVvdDs6JnF1b3Q7U3Rha2VGb3JRdW90YVdpdGhDYWxsYmFjayZxdW90OywgJnF1b3Q7aW5wdXRzJnF1b3Q7Olt7JnF1b3Q7bmFtZSZxdW90OzomcXVvdDtpZCZxdW90OywmcXVvdDt0eXBlJnF1b3Q7OiZxdW90O2J5dGVzMzImcXVvdDt9LHsmcXVvdDtuYW1lJnF1b3Q7OiZxdW90O3N1Y2Nlc3MmcXVvdDssJnF1b3Q7dHlwZSZxdW90OzomcXVvdDtib29sJnF1b3Q7fV19Cl0K"}}),t._v(" "),e("tm-code-block",{staticClass:"codeblock",attrs:{language:"solidity",base64:"Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0zLjAKcHJhZ21hIHNvbGlkaXR5cHAgJmd0Oz0wLjguMDsKCmludGVyZmFjZSBJUXVvdGFCdWlsdEluIHsKICAgIGZ1bmN0aW9uIFN0YWtlRm9yUXVvdGFXaXRoQ2FsbGJhY2soYWRkcmVzcyBiZW5lZmljaWFyeSwgdWludDY0IHN0YWtlSGVpZ2h0KSBwYXlhYmxlIGV4dGVybmFsOwp9Cgpjb250cmFjdCBBIHsKICAgIElRdW90YUJ1aWx0SW4gY29uc3RhbnQgQ29udHJhY3QgPSBJUXVvdGFCdWlsdEluKCZxdW90O3ZpdGVfMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwM2Y2YWY3NDU5YjkmcXVvdDspOwoKICAgIGV2ZW50IFN0YWtlU3VjY2VzcyhieXRlczMyIGluZGV4ZWQgaWQpOwoKICAgIGZ1bmN0aW9uIHJlcXVlc3RGb3JRdW90YShhZGRyZXNzIGJlbmVmaWNpYXJ5KSBleHRlcm5hbCBwYXlhYmxlIHsKICAgICAgICBDb250cmFjdC5TdGFrZUZvclF1b3RhV2l0aENhbGxiYWNre3ZhbHVlOiAxMzQgdml0ZX0oYmVuZWZpY2lhcnksIDI1OTIwMCk7IAogICAgfQoKICAgIC8vIFdpbGwgYmUgY2FsbGVkIGJhY2sgYnkgcXVvdGEgY29udHJhY3QKICAgIGZ1bmN0aW9uIFN0YWtlRm9yUXVvdGFXaXRoQ2FsbGJhY2tDYWxsYmFjayhieXRlczMyIGlkLCBib29sIHN1Y2Nlc3MpIGV4dGVybmFsIHsKICAgICAgICByZXF1aXJlKG1zZy5zZW5kZXIgPT0gYWRkcmVzcygmcXVvdDt2aXRlXzAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDNmNmFmNzQ1OWI5JnF1b3Q7KSk7CiAgICAgICAgaWYgKHN1Y2Nlc3MpIHsKICAgICAgICAgICAgZW1pdCBTdGFrZVN1Y2Nlc3MoaWQpOwogICAgICAgIH0gCiAgICB9Cn0K"}}),t._v(" "),e("p",[t._v("In this example, "),e("code",[t._v("StakeForQuotaWithCallbackCallback")]),t._v(" is the callback of function "),e("code",[t._v("StakeForQuotaWithCallback")]),t._v(".")])],1)}),[],!1,null,null,null);a.default=o.exports}}]);